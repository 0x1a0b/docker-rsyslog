@transport
Feature: Accept syslog messages on various network transports

  In order to collect syslog messages from multiple systems
  As a log collection service
  I want the service to support various syslog transports (UDP, TCP, RELP) and security (TLS)

  #Background: A syslog service is available
  #  Given a syslog container is running
  #  And the container has been running for at least 1 second

  Scenario: Check that syslog ports are open
    Given a server
      And a set of network ports:
        | transport protocol | port | use               |
        | udp                | 514  | legacy UDP syslog |
        | tcp                | 514  | plain TCP syslog  |
        | tcp                | 2514 | RELP syslog       |
    When we try connect to each port
    Then we should find all ports open

  @skip
  Scenario: Check that secure ports support TLS without client authentication
    Given a set of network ports:
      | transport protocol | port | use                |
      | tcp                | 6514 | secure TCP syslog  |
      | tcp                | 7514 | secure RELP syslog |
      And a trusted "certificate authority" file
    When we try connect to each port
      And we try establish a secure connection
    Then we should find all ports open
      And all ports should establish a TLS session without client authentication

  @skip
  Scenario: Check that secure ports support TLS with client authentication
    Given a set of network ports:
      | transport protocol | port | use                                                  |
      | tcp                | 8514 | secure RELP syslog with strong client authentication |
      And a trusted "certificate authority" file
      And a "private key" file and "client certificate" file
    When we try connect to each port
      And we try establish a secure connection
    Then we should find all ports open
      And all ports should establish a TLS session requesting client authentication
